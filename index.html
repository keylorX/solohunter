<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>WebView Session Test</title>
<style>
body {
  font-family: monospace;
  background: #111;
  color: #0f0;
  padding: 20px;
}
pre {
  white-space: pre-wrap;
  word-wrap: break-word;
}
</style>
</head>
<body>

<h2>WebView Auth Test</h2>
<button onclick="testAuth()">Run Test</button>

<pre id="output">Waiting...</pre>

<script>
function log(msg) {
  document.getElementById("output").textContent += "\n\n" + msg;
}

async function testAuth() {
  document.getElementById("output").textContent = "Testing...";

  try {
    log("1️⃣ Checking cookies...");
    log("document.cookie = " + document.cookie);

    log("2️⃣ Attempting authenticated API request...");

    const response = await fetch(
      "https://www.therealreal.com/api/user/profile",
      { credentials: "include" }
    );

    log("Status: " + response.status);

    const text = await response.text();
    log("Response length: " + text.length);
    log("Response preview:\n" + text.substring(0, 500));

  } catch (e) {
    log("Error: " + e.toString());
  }
}
</script>

</body>
</html>
